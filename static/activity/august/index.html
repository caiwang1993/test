<!doctype html><html><head>    <meta charset="utf-8">    <title>jQueryRotate圆盘抽奖插件</title>    <link rel="stylesheet" href="style/css/index2.css" type="text/css">    <style type="text/css">    </style></head><body><div class="ly-plate">    <div class="rotate-bg"></div>    <div class="lottery-star">        <img src="style/images/rotate-static.png" id="lotteryBtn">    </div></div><div id="dfw-game-box">    <i class="user-icon" id="user-move"></i></div><div class="prize-box-bg" id="prize-box" style="display: none">    <div class="table">        <div class="table-cell">            <div class="prize-content">            </div>        </div>    </div></div><div style="width: 100%;height: 500px"></div><script type="text/javascript" src="style/js/jquery.min.js"></script><script type="text/javascript" src="style/js/jQueryRotate.2.2.js"></script><script type="text/javascript" src="style/js/jquery.easing.min.js"></script><script type="text/javascript" src="style/js/flexible.js"></script><script type="text/javascript">    $(function () {        //弹窗出现时，禁止后台页面滚动        var ModalHelper = {            scrolltopVal: document.documentElement.scrollTop || document.body.scrollTop,                //浮层出现                afterOpen: function() {                    //记录此时浏览器滚动条位置                    scrolltopVal = document.documentElement.scrollTop || document.body.scrollTop;                    //给body添加一个bodyCls（参数名）类，样式为 bodyCls{position: fixed;width: 100%;}                    document.body.classList.add("bodyCls");                    document.body.style.top = -scrolltopVal + 'px';                },                //浮层关闭                beforeClose: function() {                    //取消body的fixed样式                    document.body.classList.remove("bodyCls");                    // scrollTop lost after set position:fixed, restore it back.                    document.documentElement.scrollTop = document.body.scrollTop = scrolltopVal;                }            };       /* var ModalHelperfun = ModalHelper();  //这个就是上面禁止浏览器滚动的方法啦。这个'modal-open'就是bodyCls的具体类名啦。*/        //关闭弹窗        $("#prize-box").click(function () {            $(this).fadeOut();            $(this).find(".prize-content div").remove();            $("#lotteryBtn").removeClass("disabled");            //取消浏览器被禁止滚动事件            ModalHelper.beforeClose();  //调用浮层关闭的方法        });        var all_step=35;//已走的步数,棋子所在位置        if(all_step!=0){            $('.js-prize-'+all_step+'').addClass("current").siblings().removeClass("current");            $("#user-move").addClass('prize-'+all_step).addClass("ini-position");        }        var timeOut = function () {  //超时函数            $("#lotteryBtn").rotate({                angle: 0,                duration: 8000,                animateTo: 2160, //这里是设置请求超时后返回的角度，所以应该还是回到最原始的位置，2160是因为我要让它转6圈，就是360*6得来的                callback: function () {                    alert('网络超时')                }            });        };        var rotateFunc = function (awards, angle, text) {  //awards:奖项，angle:奖项对应的角度            $('#lotteryBtn').stopRotate();            $("#lotteryBtn").rotate({                angle: 180,                duration: 5000,                animateTo: angle + 1440, //angle是图片上各奖项对应的角度，1440是我要让指针旋转4圈。所以最后的结束的角度就是这样子^^                callback: function () {                    stepMove(text);                    reward()                }            });        };        $("#lotteryBtn").rotate({            bind: {                click: function () {                    if($(this).hasClass("disabled")) return false;                    var data =Math.floor(Math.random()*3 + 1);                    $(this).addClass("disabled");                        if (data == 1) {                            rotateFunc(1, 0, 1)                        }                        if (data == 2) {                            rotateFunc(2, 120, 2)                        }                        if (data == 3) {                            rotateFunc(3, 240, 3)                        }                }            }        });        var result='';        for(i=0;i<=51;i++){            result+='<span class="lattice prize-'+i+' js-prize-'+i+'" data-index="'+i+'"></span>'        }        $('#dfw-game-box').append(result);        function stepMove(step) {            pre_all_step=all_step;            all_step+=step;            //如果总步数大于50，那么all_step-50            if(all_step>50){                all_step=all_step-50;                $("#user-move").removeClass('prize-'+pre_all_step).addClass('prize-'+all_step);                pre_all_step=0;                setTimeout(function(){ removeDisabled(); },2000);                return false            }            console.log(step);            console.log("all_step:"+all_step)            move(pre_all_step,all_step);        }        function move(pre_all_step,all_step) {            if (pre_all_step==all_step){return false}            //如果总前一步>总步数 -- 后退情况            if(pre_all_step>all_step){                $('.js-prize-'+all_step+'').addClass("current").siblings().removeClass("current");                $("#user-move").removeClass('prize-'+pre_all_step).addClass('prize-'+(pre_all_step-1));                setTimeout(function(){                    move(pre_all_step-1,all_step)                },300)            }else {                $('.js-prize-'+all_step+'').addClass("current").siblings().removeClass("current");                $("#user-move").removeClass('prize-'+pre_all_step).addClass('prize-'+(pre_all_step+1));                setTimeout(function(){                    move(pre_all_step+1,all_step)                },200)            }        }        function removeDisabled() {            $("#lotteryBtn").removeClass("disabled")        }        function reward() {            console.log(all_step)            var result='';            switch (all_step){                case 4: case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 17:case 18:case 20:case 21:case 23:case 26:case 28:case 29:case 31:case 32:case 33:case 36:case 37:case 39:case 40:case 42:case 44:case 45:case 47:case 48:                /*result+='<div>没有中奖</div>';                $('.prize-content').append(result);                $('#prize-box').delay(1000).fadeIn();*/                setTimeout(function(){ removeDisabled(); },1000);                    break;                case 1:                    result+='<div>2元平台币</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 2:                    result+='<div>满6减2</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 3:                    result+='<div>满10减3</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 5:                    result+='<div>满6减2</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 8:                    result+='<div>鼠标垫</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 11:                    all_step-=2;                    setTimeout(function(){ move(all_step+2,all_step); },2000);                    setTimeout(function(){ removeDisabled(); },2000);                    break;                case 15:                    result+='<div>满30减8</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 16:                    result+='<div>8元平台币</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 19:                    result+='<div>U型枕头</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 22:                    result+='<div>15元平台币</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 24:                    result+='<div>满60减15</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 25:                    result+='<div>充电宝</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 27:                    result+='<div>再来一次</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 30:                    result+='<div>20元平台币</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 34:                    result+='<div>满98减28</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 35:                    result+='<div>鼠标</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 38:                    all_step+=2;                    setTimeout(function(){ move(all_step-2,all_step); },2000);                    setTimeout(function(){ removeDisabled(); },2000);                    break;                case 41:                    result+='<div>30元无门槛</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 43:                    result+='<div>再来一次</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 46:                    result+='<div>198减50</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 49:                    result+='<div>键鼠套装</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;                case 50:                    result+='<div>100元平台币</div>';                    $('.prize-content').append(result);                    $('#prize-box').delay(1000).fadeIn();                    ModalHelper.afterOpen();  //调用浮层出现的方法                    break;            }        }    })</script></body></html>